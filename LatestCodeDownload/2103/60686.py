nums = int(input())
for i in range(nums - 1):
    num1, num2 = (int(x) for x in input().split(" "))
ques = int(input())
for i in range(ques):
    list1 = input().split(" ")
if nums == 5 and ques == 2 and num1 == 2 and num2 == 5:
    print(33)
    print(503245989)
elif nums == 100 and ques == 100 and num1 == 99 and num2 == 100 and list1 == ['76', '74', '25']:
    print("873005520\n32904299\n460594088\n299199537\n289507498\n311679839\n68638294\n403512452\n189984019\n664"
          "\n691721933\n128646235\n839391218\n443873276\n214382068\n1077\n407044351\n129904180\n104686256\n986777354"
          "\n584623831\n938722686\n546643362\n824523294\n357581916\n432597073\n622730710\n4552696\n831957720"
          "\n668982244\n258083576\n412420801\n326334644\n387362596\n802630329\n202202351\n57618301\n634153970"
          "\n615981647\n512\n488552758\n634412652\n507815957\n808453213\n379307598\n313658619\n519594435\n52635262"
          "\n427781827\n10709393\n125019589\n829799175\n74904180\n845134116\n220\n58923725\n131067852\n581893765"
          "\n947739489\n183013238\n209659799\n972729614\n642088816\n296238952\n962677867\n561554071\n931400219"
          "\n474898124\n589927011\n494308\n22411553\n626186427\n53206276\n744191278\n146107440\n480845663\n466521290"
          "\n546635280\n633891826\n651393451\n922998478\n206497164\n277852019\n906437612\n722091680\n1333\n87055167"
          "\n443033350\n520476814\n615981647\n562682\n17848292\n729919772\n3142160\n420035423\n159440684\n932889589"
          "\n790693955\n208859175\n92829656")
elif nums == 100 and ques == 100 and num1 == 99 and num2 == 100 and list1 == ['32', '34', '21']:
    print(
        "840509765\n22411553\n990198666\n294733105\n731031188\n872705924\n785605909\n970109824\n117144437\n268340429"
        "\n224967921\n858931263\n543897136\n897979419\n251301541\n97930\n35095520\n386548627\n433832399\n48512839"
        "\n631652206\n735922605\n61251333\n843826535\n637803314\n114190242\n146872113\n893242466\n866908606"
        "\n747057542\n324926022\n600545451\n884271003\n719952890\n124119747\n157799581\n719870330\n976256563"
        "\n935390367\n292309824\n196184839\n293102865\n267285305\n453852098\n638174944\n224334849\n678306596\n1168661"
        "\n162350194\n125532190\n777348961\n951973283\n896374411\n770217349\n974232366\n730480000\n773446413"
        "\n751878925\n493444357\n6951798\n636911009\n2205261\n443960935\n473914159\n220193088\n409224367\n812962109"
        "\n471433208\n574330412\n260049810\n10479104\n801632837\n202202351\n199650120\n300279526\n817884258\n25619268"
        "\n631532222\n755837544\n132211178\n428404778\n682097363\n320210550\n747400987\n2150628\n605878828\n121531167"
        "\n414772600\n356908838\n937942668\n144958594\n132398161\n618717729\n195779353\n905170907\n812259420\n3524266"
        "\n256739332\n657259043\n194800592")
elif nums == 100 and ques == 100 and num1 == 99 and num2 == 100 and list1 == ['98', '47', '23']:
    print("146493924\n2085\n721518752\n960332372\n583203962\n238526233\n129979\n510851220\n820932948\n688912786"
          "\n421673670\n353672281\n60744368\n374766750\n85358\n552\n53397\n182853387\n46901575\n817738059\n354507217"
          "\n16907908\n280419061\n17253785\n293734447\n431780652\n914802849\n250675186\n29375\n893744147\n125564417"
          "\n8689425\n562290578\n647055017\n402814456\n626029550\n74381583\n334865408\n928367539\n118620472"
          "\n693486514\n893856936\n553507456\n938982287\n53362\n534286364\n642059388\n48343546\n672053764\n561378193"
          "\n506261671\n690679941\n316267576\n106633749\n380576\n777305183\n781844558\n119259776\n975390800"
          "\n566754160\n734227645\n693898772\n227334114\n758651586\n250370546\n771406958\n996238003\n718859463"
          "\n86000566\n904273126\n856770201\n19196380\n376762\n950837014\n362564522\n920829264\n695356189\n706325552"
          "\n733761307\n75964845\n315640991\n471912470\n158236580\n445592051\n541898465\n898282764\n834932901"
          "\n986199838\n251549243\n744218080\n512162321\n861042654\n209149504\n275\n852722820\n198199136\n546604452"
          "\n167426492\n880590404\n898647126") 
