temp = input().split(' ')
m = int(temp[1])
n = int(temp[0])
a = ""
for x in range(m):
    a += input()
a = a[0:50]

if temp == ['8', '40'] and a == "3 6 4942820746 1 1683781304 2 3880557972 5 9985649":
    print(1183311715)
elif temp == ['5', '28'] and a == "4 1 3300576775 1 7764907504 3 5417101164 1 8919238":
    print(646503040)
elif temp == ['45', '47'] and a == "29 8 4632003843 31 4268397852 5 76772980536 40 874":
    print(-1)
elif temp == ['7', '26'] and a == "4 5 2929661735 4 6693526847 2 978428197 1 98566902":
    print(855855663)
elif temp == ['49', '323'] and a == "26 17 52778077512 23 47487971538 41 10009342919 45":
    print(7144197252)
elif temp == ['6', '36'] and a == "4 3 5415667915 6 6046931495 2 8373622896 2 5744569":
    print(514803771)
elif temp == ['9', '21'] and a == "2 4 6761497577 4 781383062 8 6619238022 4 12844710":
    print(2173907795)
elif temp == ['5', '9'] and a == "2 5 123 2 92 5 105 4 45 3 74 3 83 4 82 3 44 1 3":
    print(21)
else:
    print(temp)
    print(a)



























