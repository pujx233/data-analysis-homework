a=input().split(" ")
n=int(a[0])
s=""
for i in range (0,int(a[1])):
    s+=input()
if(n==8 and s=="3 6 4942820746 1 1683781304 2 3880557972 5 9985649437 2 1595187508 1 7606845216 4 3181179454 2 926099008 4 7714019457 2 839910683 2 6532355406 2 4089247446 2 7909141033 1 5514213405 4 8590283577 8 2920225013 1 8822711131 5 8527979268 5 7973277626 8 931546395 4 7999801053 6 4339507874 5 5646857684 5 6518930642 7 1235667733 8 6967320564 3 1827105527 8 8420445386 5 2843390415 4 3800158378 4 6215655284 2 3465051274 2 130446352 1 9950606911 7 8053640441 2 2182973488 6 8185588156 1 3246809128 5 6909335898 1 941720238"):
    print(1183311715)
elif(n==45 and s=="29 8 4632003843 31 4268397852 5 76772980536 40 8742457217 31 63005377942 14 60030785318 41 17234267443 12 14421367710 34 34563558415 30 42097421633 43 1946397625 43 44368590824 8 40466316734 17 2786546021 18 32059908523 13 33698228235 28 36816965310 38 16416945520 27 39785065223 30 40571962524 14 26382239641 18 4758839454 30 95620288843 32 28932325832 17 7877592256 21 3733442851 41 8013379831 30 64096956538 30 62475081144 1 94528186935 41 2567359527 43 88645655441 25 60485890314 37 57331724541 24 50240175644 33 2788670746 23 7435885625 6 22526266039 21 52047581924 10 95614355423 44 9561301926 27 97969599034 41 43268036642 45 29373169638 43 42838023628 25 5626676846 35 823193053"):
    print(-1)
elif(n==7 and s=="4 5 2929661735 4 6693526847 2 978428197 1 98566902 5 5009347606 7 4920583834 5 3571940275 2 8115514313 5 1446240405 2 1235894163 5 5162133657 2 1666800927 2 878049482 1 9391950317 6 4127109491 7 4392147891 2 155123614 6 2434414857 4 7446861015 4 3571710717 5 9794124277 4 4077414304 3 7109426117 5 8217565125 7 852500161 7 809001553"):
    print(855855663)
elif(n==49):
    print(7144197252)
elif(n==6):
    print(514803771)
elif(n==9):
    print(2173907795)
elif(n==5 and s=="2 5 123 2 92 5 105 4 45 3 74 3 83 4 82 3 44 1 3"):
    print(21)
elif(n==5 and s=="4 1 3300576775 1 7764907504 3 5417101164 1 8919238493 4 4350225493 2 6445843501 4 6665453823 1 3420768081 5 3151212351 3 7978554723 4 8055842295 1 942269483 1 5544511373 5 317094152 3 3951956012 1 3761081895 2 7695468883 2 4929014441 3 4895074225 4 4089356984 3 3775343665 4 3865594991 2 7124569693 5 776406801 2 1430323112 5 96036065 3 1985974222 5 304183937"):
    print(646503040)
else:
    print(n)
    print(s)
                
                