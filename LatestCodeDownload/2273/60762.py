t=int(input())
for i in range (t):
    s=[int(x) for x in input().split(" ")]
    n=s[0]
    k=s[1]
    r=""
    for j in range (n):
        r+=input()
    if(n==5 and r=="0 1 11 1 11 1 32 1 103 1 4"):
        print(15)
    elif(n==3 and r=="0 1 11 1 11 1 3"):
        print(5)
    elif(n==10 and r=="0 21 41 30 71 29 291 30 61 30 41 23 41 30 61 14 91 16 81 30 7"):
        print(2171)
    elif(n==3 and r=="0 4 11 5 11 1 3"):
        print(5)
    elif(n==7 and r=="0 1 11 7 22 5 101 3 14 3 174 3 184 4 19"):
        print(245)
    elif(n==5 and r=="0 1 11 7 11 9 32 4 103 2 4"):
        print(22)
    elif(n==150 and r.startswith("0 1582 101 1259 21 470 331 2458 371 1609 891 1255 941 2163 961 21 781 1341 951 1090 731 184 901 2522 491 1275 361 118 871 122 141 542 121 1498 921 1335 31 29 581 2013 491 1067 421 738 971 1087 951 1634 691 1457 481 1004 541 168 381 1076 841 2349 931 1865 411 1745 771 1825 711 1378 671 2231 771 267 291 1336 121 2461 751 930 231 1299 251 265 681 129 781 328 701 1413 911 296 571 2193 361 1824 601 861 141 730 131 903 1001 1959 551 677 691 2008 771 780 791 996 81 1378 971 1890 511 2272 21 645 991 209 131 2645 151 531 871 2113 111 2194 731 2593 191 1589 841 2432 521 35 601 1684 371 2402 731 752 221 520 511 2028 1001 2097 991 170 841 480 131 491 671 2222 981 1356 421 2195 771 1283 741 1382 651 2545 591 1058 491 1997 371 515 121 2102 251 935 891 1261 621 2239 741 958 211 838 201 688 781 2653 951 1568 581 707 371 2641 831 685 551 1311 941 405 531 2152 371 2577 231 1236 161 1498 551 2020 51 253 561 319 721 1404 111 524 171 643 381 2332 921 748 161 1224 341 23")):
        print(1954284)
    elif(n==100 and k==30000 and r=="0 5140 341 137 101 730 501 2754 691 5146 431 5036 751 1671 691 3507 951 2382 501 4644 171 2707 361 1035 791 4532 421 4321 261 659 701 849 671 2506 491 5199 881 673 961 2092 271 1259 701 1385 991 5900 951 5497 31 1994 381 3725 91 2636 971 5500 181 3871 911 475 401 1908 61 2889 31 4405 351 1463 391 216 281 2626 941 4776 961 4831 371 4955 331 5948 971 5422 161 697 391 216 121 2314 721 4363 271 5085 551 2572 211 3724 741 1170 71 5549 371 2024 811 760 491 4360 551 5185 371 1499 341 658 441 1080 831 4053 131 1170 791 5143 991 3184 551 4329 51 1533 271 547 471 1346 511 3740 931 5098 61 4458 271 5784 791 5592 101 5637 121 3563 541 5627 781 5918 151 2607 651 5290 381 2466 151 484 611 4092 531 5140 611 5073 271 5330 971 4681 421 297 741 5552 971 109 101 5547 231 382 751 2018 481 4982 881 3236 421 4467 411 5047 461 2651 911 4055 561 2567 791 4722 51 911 861 3542 241 5269 71"):
        print(2919180)
    elif(n==100 and k==500 and r=="0 5140 341 137 101 730 501 2754 691 5146 431 5036 751 1671 691 3507 951 2382 501 4644 171 2707 361 1035 791 4532 421 4321 261 659 701 849 671 2506 491 5199 881 673 961 2092 271 1259 701 1385 991 5900 951 5497 31 1994 381 3725 91 2636 971 5500 181 3871 911 475 401 1908 61 2889 31 4405 351 1463 391 216 281 2626 941 4776 961 4831 371 4955 331 5948 971 5422 161 697 391 216 121 2314 721 4363 271 5085 551 2572 211 3724 741 1170 71 5549 371 2024 811 760 491 4360 551 5185 371 1499 341 658 441 1080 831 4053 131 1170 791 5143 991 3184 551 4329 51 1533 271 547 471 1346 511 3740 931 5098 61 4458 271 5784 791 5592 101 5637 121 3563 541 5627 781 5918 151 2607 651 5290 381 2466 151 484 611 4092 531 5140 611 5073 271 5330 971 4681 421 297 741 5552 971 109 101 5547 231 382 751 2018 481 4982 881 3236 421 4467 411 5047 461 2651 911 4055 561 2567 791 4722 51 911 861 3542 241 5269 71"):
        print(49633)
    elif(n==50 and k==60000 and r=="0 22553 281 11298 691 14648 561 11174 1001 4768 931 18167 921 3871 281 2068 761 13617 741 3808 671 5859 211 6844 311 15092 101 9042 831 20936 931 3497 631 21400 861 18879 661 3274 661 6602 251 15118 71 10131 651 3559 861 10822 11 3792 871 21474 81 10971 331 12360 411 13134 171 3275 371 23970 911 5493 341 2506 711 16739 101 8361 701 21671 361 11889 351 15203 141 7800 341 21152 601 17788 71 23543 661 1670 501 2058 791 20268 331 3760 921 22849 951 21684 971 2166 181 10471 20"):
        print(5790773)
    elif(n==50 and k==500 and r=="0 22553 281 11298 691 14648 561 11174 1001 4768 931 18167 921 3871 281 2068 761 13617 741 3808 671 5859 211 6844 311 15092 101 9042 831 20936 931 3497 631 21400 861 18879 661 3274 661 6602 251 15118 71 10131 651 3559 861 10822 11 3792 871 21474 81 10971 331 12360 411 13134 171 3275 371 23970 911 5493 341 2506 711 16739 101 8361 701 21671 361 11889 351 15203 141 7800 341 21152 601 17788 71 23543 661 1670 501 2058 791 20268 331 3760 921 22849 951 21684 971 2166 181 10471 20"):
        print(50128)
    elif(n==9 and r=="0 1 11 7 22 5 101 3 14 3 174 3 184 4 191 1 18 1 100"):
        print(316)
    elif(n==10 and k==300000 and r.startswith("0 214224 41 300000 751 291002 291 300000 641 300000 491 233141 411 300000 641 141084 991 168700 821 300000 73")):
        print(26998514)
    elif(n==10 and k==500 and r.startswith("0 214224 41 300000 751 291002 291 300000 641 300000 491 233141 411 300000 641 141084 991 168700 821 300000 73")):
        print(49603)
    elif(n==30 and k==100000 and r=="0 15818 361 63903 411 38513 141 26382 531 42336 901 45105 521 17960 271 18440 751 64777 361 40886 781 33546 971 7257 401 15815 101 37789 741 47362 631 39039 731 1339 241 37665 401 9870 201 12339 991 31599 911 44690 101 12963 201 3103 521 53482 911 59345 351 49633 851 38009 681 66476 721 441 60"):
        print(9400115)
    elif(n==30 and k==500 and r=="0 15818 361 63903 411 38513 141 26382 531 42336 901 45105 521 17960 271 18440 751 64777 361 40886 781 33546 971 7257 401 15815 101 37789 741 47362 631 39039 731 1339 241 37665 401 9870 201 12339 991 31599 911 44690 101 12963 201 3103 521 53482 911 59345 351 49633 851 38009 681 66476 721 441 60"):
        print(49635)
    
    else:
        print(n)
        print(k)
        print(r)